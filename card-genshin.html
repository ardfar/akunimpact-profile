<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AkunImpact</title>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <style>
        @font-face {
            font-family: "genshin";
            src: url("assets/fonts/genshin.ttf");
        }


        .genshin-card_genshin {
            position: relative;
            font-family: "genshin";
        }

        /* Container for the small part */
        .corner-container {
            position: absolute;
            top: 0;
            right: 0;
            z-index: 1; /* Ensure it's above the image */
        }

        /* Styles for the small part */
        .genshin-corner-part {
            width: 2rem;
            height: 2rem;
            border-bottom-left-radius: 10px;
            background: #a36b5e ;
            color: #edc681;
            display: flex;
            align-items: center;
            justify-content: center;
            visibility: hidden; /* Hide by default */
        }

        .genshin-card_genshin.selected .genshin-corner-part {
            visibility: visible; /* Show only when selected */
        }

        .genshin-corner-part p {
            font-size: 1rem;
            color: #edc681;
            margin: 0;
        }
    </style>
</head>

<body class="bg-gray-500">
    <div id="imageContainerCharacter" class="flex flex-wrap justify-center relative">
        <!-- Images will be dynamically added here -->
    </div>

    <input type="hidden" class="h-[500px] w-[700px]" id="jsonDataGenshinCharacter" name="jsonDataGenshinCharacter" />

    <button onclick="extractDataCharacter()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">Extract Data</button>
    
    <button onclick="resetSelectionsCharacter()" class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded mt-4">Reset Selections</button>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        const characters = {
            'albedo.webp': 'Albedo',
            'alhaitham.webp': 'Alhaitham',
            'arataki-itto.webp': 'Arataki Itto',
            'baizhu.webp': 'Baizhu',
            'chiori.webp': 'Chiori',
            'cyno.webp': 'Cyno',
            'dehya.webp': 'Dehya',
            'diluc.webp': 'Diluc',
            'eula.webp': 'Eula',
            'furina.webp': 'Furina',
            'ganyu.webp': 'Ganyu',
            'hu-tao.webp': 'Hu Tao',
            'jean.webp': 'Jean',
            'kaedehara-kazuha.webp': 'Kazuha',
            'kamisato-ayaka.webp': 'Kamisato Ayaka',
            'kamisato-ayato.webp': 'Kamisato Ayato',
            'keqing.webp': 'Keqing',
            'klee.webp': 'Klee',
            'lyney.webp': 'Lyney',
            'mona.webp': 'Mona',
            'nahida.webp': 'Nahida',
            'navia.webp': 'Navia',
            'neuvillette.webp': 'Neuvillette',
            'nilou.webp': 'Nilou',
            'qiqi.webp': 'Qiqi',
            'raiden-shogun.webp': 'Raiden Shogun',
            'sangonomiya-kokomi.webp': 'Kokomi',
            'shenhe.webp': 'Shenhe',
            'tartaglia.webp': 'Tartaglia',
            'tighnari.webp': 'Tighnari',
            'venti.webp': 'Venti',
            'wanderer.webp': 'Wanderer',
            'wriothesley.webp': 'Wriothesley',
            'xianyun.webp': 'Xianyun',
            'xiao.webp': 'Xiao',
            'yae-miko.webp': 'Yae Miko',
            'yelan.webp': 'Yelan',
            'yoimiya.webp': 'Yoimiya',
            'zhongli.webp': 'Zhongli'
        };


        // Function to fetch images from the JSON file
        function fetchImagesCharacter() {
            const imageContainerCharacter = document.getElementById('imageContainerCharacter');

            for (const [filename_genshin, characterName_genshin] of Object.entries(characters)) {

                // Create Card_genshin 
                const card_genshin = document.createElement('div');
                card_genshin.classList.add('genshin-card_genshin', 'bg-white', 'rounded-lg', 'cursor-pointer', 'w-[150px]', 'overflow-hidden', 'transition', 'duration-300', 'ease-in-out', 'cursor-pointer', 'm-2', 'flex', 'flex-col', 'items-center', 'justify-center');
                card_genshin.setAttribute('data-clicks_genshin', '0');
                card_genshin.setAttribute('title', 'Click to Select Character');
                card_genshin.setAttribute('data-character-name', characterName_genshin); // Simpan nama karakter di sini
                card_genshin.onclick = function() { toggleSelected(this); };

                // Corner Container
                const cornerContainer_genshin = document.createElement('div');
                cornerContainer_genshin.classList.add('corner-container');
                const cornerPart_genshin = document.createElement('div');
                cornerPart_genshin.classList.add('genshin-corner-part', 'border-red-600');
                cornerContainer_genshin.appendChild(cornerPart_genshin);
                card_genshin.appendChild(cornerContainer_genshin);

                // Character Image 
                const img_genshin = document.createElement('img');
                img_genshin.classList.add('w-full', 'border-0', 'border-red-600', 'h-[85%]', 'object-cover', 'bg-[#c7c7c7]', "rounded-br-3xl");
                img_genshin.src = 'assets/images/games/genshin/characters/' + filename_genshin;
                img_genshin.alt = 'Character Image';

                // Char Name
                const characterName_genshinElement = document.createElement('p');
                characterName_genshinElement.classList.add('text-black', 'transition', 'duration-300', 'ease-in-out', 'text-center', 'bg-none', 'm-auto', 'border-0', 'border-red-600');
                characterName_genshinElement.textContent = characterName_genshin;

                card_genshin.appendChild(img_genshin);
                card_genshin.appendChild(characterName_genshinElement);
                imageContainerCharacter.appendChild(card_genshin);
            }
        }

        // Function to toggle the 'selected' class on click
        function toggleSelected(card_genshin) {
            const clicks_genshin = parseInt(card_genshin.getAttribute('data-clicks_genshin'));
            var image_genshin = card_genshin.getElementsByTagName("img")[0]
            console.log("Click: ", clicks_genshin)
            
            if (clicks_genshin < 7){
                image_genshin.classList.remove("bg-[#c7c7c7]")
                image_genshin.classList.add("bg-[#efa525]")

                card_genshin.classList.add('selected');
                card_genshin.querySelector('.genshin-corner-part').innerHTML = `<p>C${clicks_genshin}</p>`;
            } else {
                image_genshin.classList.remove("bg-[#efa525]")
                image_genshin.classList.add("bg-[#c7c7c7]")

                card_genshin.classList.remove('selected');
                card_genshin.querySelector('.genshin-corner-part').innerHTML = '';
            }

            card_genshin.setAttribute('data-clicks_genshin', clicks_genshin < 7 ? clicks_genshin + 1 : 0);
        }

        // Function to extract data from selected card_genshins
        function extractDataCharacter() {
            const selectedCard_genshins = document.querySelectorAll('.genshin-card_genshin.selected');
            const data_genshin = {
                characters: Array.from(selectedCard_genshins).map(card_genshin => ({
                    name: card_genshin.getAttribute('data-character-name'), // Ambil nama karakter langsung dari atribut data
                    enhancement: parseInt(card_genshin.getAttribute('data-clicks_genshin')) % 7
                }))
            };
            const jsonDataGenshinCharacterInput = document.getElementById('jsonDataGenshinCharacter');
            jsonDataGenshinCharacterInput.value = JSON.stringify(data_genshin);
            console.log(jsonDataGenshinCharacterInput.value); // Output JSON for debugging
        }

        // Fetch images when the page loads
        window.onload = function() {
            fetchImagesCharacter();
        };

        // Function to reset all selected card_genshins
        function resetSelectionsCharacter() {
            const selectedCard_genshins = document.querySelectorAll('.genshin-card_genshin.selected');
            for (const card_genshin of selectedCard_genshins) {
                card_genshin.classList.remove('selected');
                card_genshin.querySelector('.genshin-corner-part').innerHTML = '';
                card_genshin.setAttribute('data-clicks_genshin', '0');
                // Remove the golden background class
                const image_genshin = card_genshin.querySelector('img_genshin');
                image_genshin.classList.remove('bg-[#efa525]');
                image_genshin.classList.add('bg-[#c7c7c7]');
            }
        }


    </script>
</body>

</html>
